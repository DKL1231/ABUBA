### 웹 어플리케이션
- 웹 서버(web server)
    
     정적인 파일을 응답함.
    
- 웹 어플리케이션 서버(web application server)
    
     프로그램 코드를 실행해서 애플리케이션 로직 수행
    

웹서버는 어플리케이션 로직같은 동적인 처리가 필요하면 WAS에 요청을 위임하고, WAS는 중요한 어플리케이션 로직처리를 전담한다. 

# 서블릿


웹 어플리케이션 서버를 직접 구현하게 되면, 위와 같은 모든 과정을 수행하는 로직을 설계해야한다.

하지만 서블릿은 개발자가 비지니스 로직을 설계하는데 집중할 수 있도록 나머지 기능을 수행한다.



서블릿 구조

웹브라우저의 요청이 들어오게 되면,

1. WAS는 request와 response객체를 생성하고, 서블릿 컨테이너 내부의 서블릿 객체를 호출한다. 
2. 개발자가 Request/ Response객체에서 HTTP요청/응답 정보를 사용하여 로직을 설계한다.
3. WAS는 Response객체에 담긴 내용으로 HTTP응답 정보를 생성한다.

- 톰캣과 같이 서블릿을 지원하는 WAS를 서블릿 컨테이너라고한다.
    - 서블릿 컨테이너: 서블릿 객체 생성, 초기화, 호출, 종료 등 생명주기를 관리한다.
- 서블릿 객체는 싱글톤으로 관리한다.
    - ‼️공유 변수 사용을 주의하자!
- 동시 요청을 위한 멀티 쓰레드 처리를 지원한다.
    - 동시에 많은 요청이 들어와도 처리할 수 있다.
    

---

## ‼️동시 요청 - 멀티 쓰레드

서블릿은 동시요청을 처리할 수 있게 해주는데, 어떻게 동시요청을 처리할까?

→ 쓰레드를 활용한다.

- 쓰레드
    - 애플리케이션 코드를 하나씩 순차적으로 실행하는 단위
    - 쓰레드는 한번에 하나의 코드라인만 수행할 수 있다.

### 요청 마다 쓰레드를 생성하고, 종료하는 방식

- 리소스(cpu,메모리)가 허용할 때 까지 처리가 가능하다.
- 쓰레드 생성 비용이 높다.
    - 고객의 요청이 올때마다 새로운 쓰레드를 생성하기 때문에, 응답 속도가 늦다.
- 컨텍스트 스위치 비용이 발생한다.
- 고객의 요청이 많은 경우, 리소스가 임계점을 넘어서 서버가 죽을 수 있다.

### 쓰레드 풀을 사용하는 방식(개수를 제한하여 미리 쓰레드를 생성한후 재사용)

- 쓰레드 풀
    - 쓰레드를 풀에 보관하며 관리하는 역할이다.
- 쓰레드가 필요한경우, 이미 생성되어있는 쓰레드를 쓰레드 풀에서 꺼내어 사용하고, 반납한다.
- 가용한 쓰레드가 없는 경우 대기하거나 요청을 거절한다.
- 쓰레드의 생성비용이 들지 않으므로, 응답 시간이 빠르다.
- 많은 요청이 들어와도 서버가 죽을 위험이 낮다.